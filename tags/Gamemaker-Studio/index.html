<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>标签: Gamemaker Studio - Rasin&#039;s Blog</title><meta property="og:type" content="blog"><meta property="og:title" content="Rasin&#039;s Blog"><meta property="og:url" content="https://rasin.me/"><meta property="og:site_name" content="Scienage Mafelteens"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://rasin.me/img/og_image.png"><meta property="article:author" content="Rasin Gue"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://rasin.me"},"headline":"Rasin's Blog","image":["https://rasin.me/img/og_image.png"],"author":{"@type":"Person","name":"Rasin Gue"},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-166789681-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-166789681-2');</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Rasin&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">Gamemaker Studio</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-03-23T19:35:55.000Z" title="2021-03-23T19:35:55.000Z">2021-03-23</time><span class="level-item">8 分钟 读完 (大约 1131 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/03/23/%E9%87%8D%E8%BF%94Gamemaker%20Studio2/">重返Gamemaker Studio 入门篇2</a></h1><div class="content"><p>在线文档: <a href="https://manual-en.yoyogames.com/#t=Content.htm">GameMaker Studio 2 Manual</a><br>官方社区: <a href="https://forum.yoyogames.com/index.php">GameMaker Community</a><br>知识库：<a href="https://help.yoyogames.com/hc/en-us/categories/204246668-GameMaker-Studio-2">GameMaker Knowledge Base</a></p>
<p>本系列参考的教程：<a href="https://www.youtube.com/watch?v=izNXbMdu348&list=PLPRT_JORnIupqWsjRpJZjG07N01Wsw_GJ">GameMaker Studio 2: Complete Platformer Tutorial</a></p>
<hr>
<h2 id="添加枪械"><a href="#添加枪械" class="headerlink" title="添加枪械"></a>添加枪械</h2><p>人物将会携带枪支进行射击。首先要添加枪械的贴图和对象。由于枪械是一个长矩形，并且根据常识，人物应该在枪械的后半部把持着。因此，将枪械的原点设在偏后半部的中心位置比较妥当。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210227201918.png" alt="Gun"></p>
<p>再者，枪械一般位于胸部位置，而玩家贴图是Q版一比一身材，因此将其置于身体中心再向下一些的位置。我们在 <code>oGun</code> 对象的 <code>BeginStep</code> 事件中添加代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">x &#x3D; oPlayer.x<br>y &#x3D; oPlayer.y + 9 &#x2F;&#x2F;较为合适的位置<br></code></pre></td></tr></table></figure>

<p>我们希望枪械的前端将会指向鼠标的方向，并且鼠标在人物左右的时候，枪械也会自动跟随鼠标翻转：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plain">image_angle &#x3D; point_direction(x, y, mouse_x, mouse_y) &#x2F;&#x2F;鼠标的坐标<br>if (image_angle &gt; 90) and (image_angle &lt; 270)&#123; &#x2F;&#x2F;逆时针计算角度，零度为正下方<br>    image_yscale &#x3D; -1<br>&#125;<br>else&#123;<br>    image_yscale &#x3D; 1<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="添加子弹"><a href="#添加子弹" class="headerlink" title="添加子弹"></a>添加子弹</h2><p>子弹是一个两帧动画，首先是一个圆形，之后变成一个带着小尾巴的圆。我们希望子弹在发射出去之后，保持第二帧动画不变，直到碰到墙壁消失。那么可以通过 <code>oBullet</code>对象的 <code>Animation End</code> 事件代码实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">image_speed &#x3D; 0 &#x2F;&#x2F;当动画结束时，将动画速度设为0，即不再播放<br>image_index &#x3D; 1 &#x2F;&#x2F;将动画帧数设为第二帧<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210227201857.png" alt="Bullet"></p>
<p>接下来，在 <code>Post Draw</code> 事件中，我们添加碰到墙体后子弹销毁的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">if (place_meeting(x, y, oWall))<br>    instance_destroy() &#x2F;&#x2F;该实例销毁<br></code></pre></td></tr></table></figure>

<p>这里的 <code>Post Draw</code> 事件，是指在绘制一旦结束之后就立即检测。官方文档的解释是：</p>
<blockquote>
<p>The <strong>Post Draw</strong> event is triggered after the standard draw events, but before the Draw GUI events. Like the Pre Draw event, it is based on the size of the screen buffer size, and is placed before the Draw GUI events to enable you to perform post-processing effects and other things on a full screen basis simply and easily without interfering with any HUD/GUI elements that you may have in your game.</p>
</blockquote>
<p>论坛中网友的解释是</p>
<blockquote>
<p>the Post Draw event is the moment in between the Draw events and the image being sent to the screen.</p>
</blockquote>
<p>简单点理解就是，游戏引擎在绘制之后，还没有把绘制完成的东西送到显示屏上就立即执行的事件。</p>
<h2 id="枪械射击与后坐力"><a href="#枪械射击与后坐力" class="headerlink" title="枪械射击与后坐力"></a>枪械射击与后坐力</h2><p>枪械连击中间需要加入一个延迟，并且枪械在发射子弹的过程中最好还带有一个后坐力的效果。首先我们先在 <code>oGun</code> 的 <code>Create</code> 事件中声明一下相关变量:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">firingdelay &#x3D; 1 &#x2F;&#x2F; 发射间隔<br>recoil &#x3D; 0 &#x2F;&#x2F; 后坐力<br></code></pre></td></tr></table></figure>

<p>依旧是在 <code>Begin Step</code> 事件中，我们添加对于射击延迟和后坐力的一个检测：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">firingdelay &#x3D; firingdelay - 1 &#x2F;&#x2F; 每个时间片减少1计时<br>recoil &#x3D; max(0, recoil - 1) &#x2F;&#x2F; 后坐力取0和当前值减1的最大值<br><br>if (mouse_check_button(mb_left)) &amp;&amp; (fd&lt;0)&#123; &#x2F;&#x2F;当鼠标左键点击并且延迟计时小于0时<br>    recoil &#x3D; 4  &#x2F;&#x2F;设定后坐力<br>    fd &#x3D; 5  &#x2F;&#x2F;设定设计间隔<br>    <br>    with (instance_create_layer(x, y, &quot;Bullets&quot;, oBullet))&#123; &#x2F;&#x2F;with 语句<br>        speed &#x3D; 25 &#x2F;&#x2F; 将对应创建的新bullet对象赋予速度<br>        direction &#x3D; other.image_angle + random_range(-3, 3) &#x2F;&#x2F; other 指with中指代的对象，这里加入一个随机数使得子弹不会单纯往一个方向设计，而是在一个小的随机范围内发射<br>        image_angle &#x3D; direction &#x2F;&#x2F;重新设定子弹行进的方向<br>    &#125;	<br>&#125;<br><br>x &#x3D; x - lengthdir_x(recoil, image_angle) &#x2F;&#x2F;往发射角度的反向延长线上后退<br>y &#x3D; y - lengthdir_y(recoil, image_angle)<br></code></pre></td></tr></table></figure>

<p>官方文档中对于 <code>with</code> 语句的解释是：</p>
<blockquote>
<p>In a number of cases you want to do a lot more than just change a single variable within those other instances, and may want to perform more complex code actions that require multiple functions and lines of code.</p>
</blockquote>
<blockquote>
<p>Once the expression has set the scope of the with, the statement will then be executed for each of the indicated instances, as if that instance is the current (self) instance.</p>
</blockquote>
<p>也就是说，<code>with</code> 可以再指定一个新对象，这个新对象在 <code>with</code> 语句中用 <code>other</code> 来指代。</p>
<p>这时候要记得在 <code>Room1</code> 中添加两个新层 <code>Bullets</code> 和 <code>Gun</code>，这两层应置于 <code>Player</code>上方。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-23T19:35:55.000Z" title="2021-02-23T19:35:55.000Z">2021-02-23</time><span class="level-item">17 分钟 读完 (大约 2543 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/02/23/%E9%87%8D%E8%BF%94Gamemaker%20Studio1/">重返Gamemaker Studio 入门篇1</a></h1><div class="content"><blockquote>
<p>空有雄心壮志，不如脚踏实地从简单做起。</p>
</blockquote>
<p>经历了三年空窗期，虽说实际情况产生了不可计量的变化，也和当时想做游戏的简单初衷相去甚远。但愿望如果不开始付诸实际，只会停留在空想。因此还是准备从简单做起，不想因为复杂的实现和编程花费太多时间，而把重心侧重在玩法和构思上面，GameMaker Studio 2 貌似是一个比较折中的选择。闲话少叙，从一个简单的平台冒险类游戏下手，基本能够达到目前构思游戏demo的制作需求。本系列的目的是在跟着教程实践的基础上，对游戏制作过程的一个简单记录，仅供自己回顾，不做教程目的。</p>
<hr>
<p>在线文档: <a href="https://manual-en.yoyogames.com/#t=Content.htm">GameMaker Studio 2 Manual</a><br>官方社区: <a href="https://forum.yoyogames.com/index.php">GameMaker Community</a><br>知识库：<a href="https://help.yoyogames.com/hc/en-us/categories/204246668-GameMaker-Studio-2">GameMaker Knowledge Base</a></p>
<p>本系列参考的教程：<a href="https://www.youtube.com/watch?v=izNXbMdu348&list=PLPRT_JORnIupqWsjRpJZjG07N01Wsw_GJ">GameMaker Studio 2: Complete Platformer Tutorial</a></p>
<hr>
<h2 id="界面介绍"><a href="#界面介绍" class="headerlink" title="界面介绍"></a>界面介绍</h2><p>在打开游戏IDE之后，我们可以看到几个区域。如图所示，中间部分是工作区，所有基本的元素编辑和代码撰写都在这里。右边是素材区，已经被多个文件夹详细划分。左上是菜单栏和工具栏，最左一栏为房间设置栏，之后再详细讨论其使用方法。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210223200012.png" alt="IDE"></p>
<p>工作区的操作同大多数游戏一样，通过滚轮滑动调整上下，点击中键进行移动，按住<code>Ctrl</code>键加上滚轮滑动可以控制工作区的界面缩放，也可以使用 <code>Ctrl + +</code> 和 <code>Ctrl + -</code> 达到相同效果。</p>
<p>再进行工作的时候，可以使用快捷键 <code>F12</code> 将工作区最大化，方便编辑。</p>
<h2 id="创建贴图"><a href="#创建贴图" class="headerlink" title="创建贴图"></a>创建贴图</h2><p>可以直接在工作区里点击 <code>右键→Assets→Create Sprite</code>；或者在素材区对应的文件夹里如前者一般创建。唯一的区别是，直接在工作区里创建的文件存储在根目录，而对应文件夹创建可以更加分门别类，当然也可以重新拖放文件达到相同效果。同理，其他需要创建的东西也可以这样操作。</p>
<p>以下就是一个空的贴图文件配置。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210223200815.png" alt="sprite"></p>
<p>贴图可以根据我们的需要进行命名，命名一般需要规则，如玩家静止贴图用 <code>sPlayer</code>, 玩家跑动贴图用 <code>sPlayerR</code>，玩家跳跃贴图用 <code>sPlayerA</code>。下方的 <code>Size</code> 需要注意，一般是 <code>64*64</code> 的像素大小，也可以点击按钮进行调整。右边的 <code>Edit Image</code> 可以直接在编辑器里面编辑。我个人觉得还是使用更完备的外部编辑器画好再导入进来，比如 <code>Aseprite</code> 或 <code>Photoshop</code>等等。下面的 <code>Import</code> 按钮可以导入图片。导入图片可以是单张贴图或者多帧动画。注意这里导入的动画实际上是拼贴好的 <code>png</code> 文件，文件名以 <code>_strip(num)</code> 结尾，其中 <code>num</code> 是实际上帧的数量。这样导入的图片将会自动被切割成 <code>num</code> 数量的帧。如下图所示，一张拼贴好的4帧 <code>sPlayer_r_strip4.png</code> 文件：</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210223202502.png" alt="strip_4"></p>
<p>左下角的 <code>Collision Mask</code> 是用于检测游戏对象碰撞的大小，可以通过手动自行设置或者自动检测来调整。</p>
<p>右侧是动画界面，右上角是动画帧率。注意这里的帧率<strong>仅用于显示</strong>，而<strong>不是</strong>指游戏内的<strong>实际帧率</strong>。右边的坐标指定该贴图的圆心位置，一般可以直接使用 <code>Middle Centre</code> 让系统自动指定。</p>
<p>这里我们创建了两个基本的贴图：<code>sPlayer</code>和 <code>sWall</code>，并将素材导入。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210223214139.png" alt=""></p>
<h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><p>贴图只是纯粹的图片，不能执行游戏中的指令和效果，因此就需要创建对象并绑定贴图。首先，我们先创建一个玩家对象 <code>oPlayer</code>，并将刚才创建好的 <code>sPlayer</code> 进行绑定。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210223214535.png" alt="oPlayer"></p>
<p>下方的 <code>Events</code> 可以用来管理对象相关的所有事件。点击并创建新的事件。首先，<code>Create</code> 事件对应在对象创建时，我们需要初始化一些简单的变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">hsp &#x3D; 0    &#x2F;&#x2F;水平速度<br>vsp &#x3D; 0    &#x2F;&#x2F;垂直速度<br>grv &#x3D; 0.3  &#x2F;&#x2F;重力<br>walksp &#x3D; 4 &#x2F;&#x2F;行走速度<br></code></pre></td></tr></table></figure>

<p>紧接着，我们创建 <code>Step</code>事件。<code>Step</code> 事件管理每个时间片里面需要执行的内容，因此代码会较为复杂。首先定义以下按键：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">&#x2F;&#x2F;Get Player Input<br>key_left &#x3D; keyboard_check(vk_left) || keyboard_check(ord(&quot;A&quot;)) &#x2F;&#x2F;方向键左或者键A<br>key_right &#x3D; keyboard_check(vk_right)|| keyboard_check(ord(&quot;D&quot;)); &#x2F;&#x2F;方向键右或者键D<br>key_jump &#x3D; keyboard_check_pressed(vk_space)|| keyboard_check_pressed(ord(&quot;W&quot;)); &#x2F;&#x2F;空格键或键W，仅需点击即可<br></code></pre></td></tr></table></figure>

<p>这样就定义好了基本的行动按键。接下来，对应的按键要加上其逻辑才能有实际意义。我们继续定义一下运动的状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">var move &#x3D; key_right - key_left &#x2F;&#x2F; &#96;var&#96; 用于声明局部变量<br>hsp &#x3D; move * walksp &#x2F;&#x2F; 水平速度等于行动方向乘行走速度<br>vsp &#x3D; vsp + grv;  &#x2F;&#x2F; 垂直速度等于现有垂直速度加上重力速度<br></code></pre></td></tr></table></figure>

<p>首先定义了一个临时变量 <code>move</code>。<code>move</code> 在这里是一个布尔值，当 <code>key_right</code>为 <code>True</code> 且 <code>key_left</code> 为 <code>False</code> 时，<code>move</code>值为 <code>1</code> ；当 <code>key_right</code>为 <code>False</code> 且 <code>key_left</code> 为 <code>True</code> 时，<code>move</code> 值为 <code>-1</code> 。这样就可以将作为一个方向的标识。</p>
<p>正如我们在 <code>Create</code> 事件中定义的几个基础的速度变量，在 <code>Step</code> 事件中需要对行进速度进行实时更改。对于水平速度如此定义无可厚非，但垂直速度并没有按照物理学的实际情况算上加速度，只是简单的通过在每个时间片减去重力的速度达到下落的效果。</p>
<h2 id="碰撞检测"><a href="#碰撞检测" class="headerlink" title="碰撞检测"></a>碰撞检测</h2><p>如果不做碰撞检测，那么人物在水平行进和下落的时候就不会被墙阻挡住，就没有办法进行游戏。因此要对人物和墙体之间做碰撞检测。先从跳跃开始：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">&#x2F;&#x2F; Jump<br>if (place_meeting(x, y+1, oWall)) &amp;&amp; (key_jump)&#123;<br>    vsp &#x3D; -7<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>place_meeting</code> 函数用于检查某个对象实例的 <code>Collision Mask</code> 与另一个实例或对象的所有实例的碰撞检测。因此这个函数可以检测玩家对象和所有的墙体，而不需要对单个墙体进行设定。由于房间坐标的左上顶点是 <code>(0, 0)</code>，因此垂直的负方向是向上，因此向上跳跃的速度设为负值。触发跳跃的条件是当玩家位于墙对象上分且按下跳跃。</p>
<p>水平移动要算上玩家的移动速度。因此在 <code>place_meeting</code> 函数中需要注意：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">if (place_meeting(x+hsp, y, oWall))&#123; &#x2F;&#x2F;加上玩家的速度 也就是下一个时间片原本的位移<br>    while (!place_meeting(x+sign(hsp), y, oWall))&#123; &#x2F;&#x2F;当还没碰到墙时要继续移动，这里用方向表示更简洁<br>        x &#x3D; x + sign(hsp) &#x2F;&#x2F;继续移动到墙边<br>    &#125;<br>    hsp &#x3D; 0 &#x2F;&#x2F;将移动速度设为0<br>&#125;<br><br>x &#x3D; x + hsp; &#x2F;&#x2F;更改玩家横坐标位置<br></code></pre></td></tr></table></figure>

<p>同理，垂直移动也可以用类似的代码来实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">&#x2F;&#x2F;Vertical Collision<br>if (place_meeting(x, y+vsp, oWall))&#123;<br>	<br>	while (!place_meeting(x, y+sign(vsp), oWall))&#123;<br>		y &#x3D; y + sign(vsp);<br>	&#125;<br>	vsp &#x3D; 0;<br>&#125;<br>y &#x3D; y + vsp;<br></code></pre></td></tr></table></figure>

<h2 id="动画效果"><a href="#动画效果" class="headerlink" title="动画效果"></a>动画效果</h2><p>在移动的基础上增加动画能使得游戏演示看起来更自然生动。这里重新创建两个贴图：<code>sPlayerR</code> 为奔跑动画，<code>sPlayerA</code> 为在空中的动画。我们需要玩家在跑动的时候播放奔跑动画，在跳跃的时候播放空中的动画。现在依旧需要用碰撞来检测玩家的具体位置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plain">if (!place_meeting(x, y+1, oWall))&#123; &#x2F;&#x2F;不和墙体接触，即在空中时<br>    sprite_index &#x3D; sPlayerA &#x2F;&#x2F;将动画切换成空中动画<br>    image_speed &#x3D; 0 &#x2F;&#x2F; 将动画循环速度常数设为0，即整个动作只播放一次<br>    if (sign(vsp) &gt; 0)&#123; &#x2F;&#x2F;若玩家处于下落状态时<br>        image_index &#x3D; 1; &#x2F;&#x2F;仅播放第二帧<br>    &#125;<br>    else&#123;<br>        image_index &#x3D; 0; &#x2F;&#x2F;播放第一帧<br>    &#125;<br>&#125;<br>else&#123; &#x2F;&#x2F;在地面的情况<br>    image_speed &#x3D; 1; &#x2F;&#x2F;常速播放动画<br>    if (hsp &#x3D;&#x3D; 0)&#123;<br>        sprite_index &#x3D; sPlayer &#x2F;&#x2F;播放静止动画<br>    &#125;<br>    else&#123;<br>        sprite_index &#x3D; sPlayerR &#x2F;&#x2F;播放运动动画<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>跑动也有正反方向。Gamemaker Studio 提供了一个取巧的功能使得美术不需要画两个方向的动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">if (hsp !&#x3D;0)&#123; &#x2F;&#x2F;在水平运动的时候<br>    image_xscale &#x3D; sign(hsp) &#x2F;&#x2F;运动方向的正负决定动画方向<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="房间设置"><a href="#房间设置" class="headerlink" title="房间设置"></a>房间设置</h2><p>做好了基本的对象和相关事件，我们应该将其放到实际的游戏中进行测试。在 <code>Rooms</code> 文件夹中创建一个新房间 <code>Room1</code>。界面的左上方有一个房间图层，如同 <code>Photoshop</code> 一样，居于最上的最前，居于最下的最后。除了原有的 <code>Background</code>，我们创建两个新的图层 <code>Player</code>和 <code>Wall</code>。</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210225195516.png" alt="Layers"></p>
<p>之后我们将玩家对象和墙体对象拖入，按住 <code>alt</code> 键可以批量生成。如下图就是一个房间的示例：</p>
<p><img src="https://raw.githubusercontent.com/rasin-tsukuba/blog-images/master/img/20210225200123.png" alt="Room1"></p>
<p>如果没有什么问题的话，点击上方的 <code>Run</code> 按钮或快捷键 <code>F5</code>就可以运行游戏了。</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/img/avatar.png" alt="Rasin Gue"></figure><p class="title is-size-4 is-block line-height-inherit">Rasin Gue</p><p class="is-size-6 is-block">PhD in Progress</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Tsukuba, Japan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">3</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/RasinGue" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/RasinGue"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/mizumori_setsu"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com/rasin"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-05-05T21:31:55.000Z">2021-05-05</time></p><p class="title is-6"><a class="link-muted" href="/2021/05/05/The%20History%20of%20Jazz%20--%20Chapter%201/">The History of Jazz -- 爵士乐史前史 Music</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-03-23T19:35:55.000Z">2021-03-23</time></p><p class="title is-6"><a class="link-muted" href="/2021/03/23/%E9%87%8D%E8%BF%94Gamemaker%20Studio2/">重返Gamemaker Studio 入门篇2</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-23T19:35:55.000Z">2021-02-23</time></p><p class="title is-6"><a class="link-muted" href="/2021/02/23/%E9%87%8D%E8%BF%94Gamemaker%20Studio1/">重返Gamemaker Studio 入门篇1</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-12T15:31:55.000Z">2020-06-12</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/12/%E7%8B%AC%E4%B8%8E%E5%AD%A4/">独与孤</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Gamemaker-Studio/"><span class="tag">Gamemaker Studio</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Jazz/"><span class="tag">Jazz</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/joural/"><span class="tag">joural</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Rasin&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2021 Rasin Gue</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://rasin.me',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>